(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{510:function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?> <svg version=1.1 id=图层_1 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink x=0px y=0px viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space=preserve> <g id=Artboard> <polygon id=Triangle-3-Copy-13 style=fill:#a5a5a5 points="8,5.5 3,9 3,2 \t"/> </g> </svg> '},511:function(t,e){t.exports='<?xml version="1.0" encoding="utf-8"?> <svg data-name="Layer 1" xmlns=http://www.w3.org/2000/svg viewBox="0 0 15.6 15.6"> <path d="M9.2 7.8l6.4-6.4L14.2 0 7.8 6.4 1.4 0 0 1.4l6.4 6.4L0 14.2l1.4 1.4 6.4-6.4 6.4 6.4 1.4-1.4z" fill=#a5a5a5> </path> </svg> '},574:function(t,e,n){},584:function(t,e,n){"use strict";n.r(e);var o=n(37),r=n(1),i=n(453),l=n.n(i),a=n(33),s=n(495),c=n(583),u=n(510),d=n.n(u);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,o=g(t);if(e){var r=g(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(t,e){if(e&&("object"===f(e)||"function"==typeof e))return e;return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,n)}}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var m=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(n,o["default"].Component);var e=y(n);function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),e.apply(this,arguments)}return function(t,e,n){e&&p(t.prototype,e),n&&p(t,n)}(n,[{key:"shouldComponentUpdate",value:function(t){return JSON.stringify(this.props)!==JSON.stringify(t)}},{key:"handleClick",value:function(t,e){this.props.onClick(t,e)}},{key:"render",value:function(){var t=this,e=this.props.guid,n=l()(this.props.className,"toc-entry",this.props.type,"heading-".concat(this.props.level),"header-indent-".concat(this.props.indent),{hasChildren:this.props.hasChildren,collapsed:this.props.collapsed});return o.default.createElement("li",{className:n,"data-index":this.props.index,"data-guid":e,"data-offset":this.props.offset,onClick:function(){return t.handleClick(t.props.element,t.props.offset)}},this.props.hasChildren&&o.default.createElement("span",{className:"icon-collapsed",dangerouslySetInnerHTML:{__html:d.a},onClick:this.props.handleCollapsed}),o.default.createElement("div",{className:"dic-text"},this.props.text))}}]),n}(),v=n(511),b=n.n(v);function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(){return(C=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t}).apply(this,arguments)}function k(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return S(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function x(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function O(t,e){return(O=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function T(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,o=L(t);if(e){var r=L(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return function(t,e){if(e&&("object"===w(e)||"function"==typeof e))return e;return E(t)}(this,n)}}function E(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(t){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var P=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&O(t,e)}(n,o["default"].Component);var e=T(n);function n(t){var o;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),(o=e.call(this,t)).editorRoot=document.querySelector(".ql-editor"),o.content=null,o.lines=[],o.state={currentHeader:{},currentParent:[],list:[],listClass:[],scrollTop:0,titleLength:0,collapsed:!1},o.debounceSyncScrolling=Object(a.debounce)(o.syncScrolling.bind(E(o)),200),o.debounceUpdatePosition=Object(a.debounce)(function(){window.innerWidth<1144?o.toggleTitleCollapsed(!0):o.props.updatePosition(o.state.collapsed)},1e3/60),o.handleCollapsed=o.handleCollapsed.bind(E(o)),o.handleTitleCollapsed=o.handleTitleCollapsed.bind(E(o)),o}return function(t,e,n){e&&x(t.prototype,e),n&&x(t,n)}(n,[{key:"componentDidMount",value:function(){this.ps=s.initialize(this.content),this.updateAndShow(),window.addEventListener("resize",this.debounceUpdatePosition),this.props.editorScrollingContainer.addEventListener("scroll",this.debounceSyncScrolling)}},{key:"componentWillUnmount",value:function(){this.ps.destroy(),window.removeEventListener("resize",this.debounceUpdatePosition),this.props.editorScrollingContainer.removeEventListener("scroll",this.debounceSyncScrolling)}},{key:"scrollToHeader",value:function(t){var e=this.content;if(!t.offset)return e.scrollTop=0,void s.update(e);var n=document.getElementById("new-directory").querySelectorAll(".toc-entry")[this.state.list.indexOf(t)];if(n&&!n.classList.contains("hide")){var o=n.offsetTop,r=e.scrollTop,i=e.scrollTop+e.offsetHeight;o<r&&(e.scrollTop=o),o>=i-n.offsetHeight&&(e.scrollTop=o-e.offsetHeight+n.offsetHeight),s.update(e)}}},{key:"getHeaderLines",value:function(){var t=this,e=this.editorRoot.querySelectorAll('.ql-heading-title, [data-header], [class*="ql-heading-"]'),n=[],o=k(e).reduce(function(e,o){if(o.textContent.trim()){n.push(o);var r={element:o,level:t.getLevel(o),offset:o.offsetTop,text:o.textContent,collapsed:!1,type:""};if(o.classList.contains("ordered-item")){var i=o.dataset.listContent;r.text=i+r.text}o.classList.contains("bullet-item")&&(r.type=o.parentElement.dataset.listStyle),e.push(r)}return e},[]);return this.lines=n,o}},{key:"getLevel",value:function(t){return t.classList.contains("ql-heading-title")?4:(t.dataset.header?e=t.dataset.header:"LI"===t.tagName&&(e=Number(t.className.match(/ql-heading-(\d)/)[1])),4-e);var e}},{key:"renderList",value:function(){var t,e=this;if(0===this.state.list.length)t=o.default.createElement("li",{className:"dir-not-found"},"添加标题后会在这里自动生成目录。");else{var n={};t=this.state.list.map(function(t,r,i){if(!t.text)return null;for(var s=t.level,c=!1,u=r-1;i[u]&&i[u].level<=s;)u--;i[u]&&(i[u].collapsed||n[u])&&(c=!0,n[r]=!0);var d=i[r+1]&&t.level>i[r+1].level,f=l()({currentHeader:e.state.currentHeader.offset===t.offset,currentParent:!!Object(a.find)(e.state.currentParent,["offset",t.offset]),hide:c});return o.default.createElement(m,C({},t,{key:r,index:r,parentIndex:u,className:f,hasChildren:d,onClick:e.handleEntryClick,handleCollapsed:e.handleCollapsed}))})}var r=l.a.apply(void 0,["doc-directory-list"].concat(k(this.state.listClass),[{"has-more-title":this.state.titleLength>1,"has-only-title":this.state.titleLength<=1}]));return o.default.createElement("ul",{className:r},t)}},{key:"syncScrolling",value:function(){for(var t=this.editorRoot.offsetTop,e=this.props.editorScrollingContainer.scrollTop-t,n=this.state.list,o=this.state.list.reduce(function(t,n){return t.offset>e?t:n.offset<=e?n:t},{offset:0}),r=[],i=n.indexOf(o)-1,l=o.level;n[i]&&l<4;){for(;n[i]&&n[i].level<=l;)i--;n[i]&&(l=n[i].level,r.push(n[i]))}this.setState({currentHeader:o,currentParent:r}),this.scrollToHeader(o)}},{key:"update",value:function(){var t=this.getHeaderLines(),e=0,n=t.reduce(function(t,n){var o="has-heading-"+n.level;return o.indexOf("4")>-1&&(e+=1),-1===t.indexOf(o)&&t.push(o),t},[]);return Object(a.isEqual)(this.state.list,t)||this.setState({list:t,listClass:n,titleLength:e}),t}},{key:"updateAndShow",value:function(){if(0!==this.update().length)return this.toggleTitleCollapsed(!1),!0}},{key:"handleEntryClick",value:function(t,e){Object(r.c)(t),r.b.track(4,"点击目录按钮")}},{key:"handleCollapsed",value:function(t){t.stopPropagation();var e=this.state.list,n=t.target.closest(".toc-entry"),o=n.getAttribute("data-index"),i=!n.classList.contains("collapsed");e[o].collapsed=i,this.setState({list:e}),i?r.b.track(4,"点击目录项展开"):r.b.track(4,"点击目录项折叠")}},{key:"toggleTitleCollapsed",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.collapsed;this.setState({collapsed:e},function(){t.props.updatePosition(t.state.collapsed),t.props.onToggle(e)})}},{key:"handleTitleCollapsed",value:function(){this.toggleTitleCollapsed()}},{key:"render",value:function(){var t=this;return o.default.createElement("div",{id:"new-directory",className:"table-of-content"},o.default.createElement(c.a,{title:"显示目录",placement:"right"},o.default.createElement("div",{className:"doc-directory-menu",onClick:this.handleTitleCollapsed},o.default.createElement("div",{className:"doc-directory-menu-line"}),o.default.createElement("div",{className:"doc-directory-menu-line"}),o.default.createElement("div",{className:"doc-directory-menu-line"}))),o.default.createElement("div",{className:"new-doc-directory"},o.default.createElement("div",{className:"doc-directory-title"},o.default.createElement("span",null,"目录"),o.default.createElement("span",{className:"doc-directory-close",dangerouslySetInnerHTML:{__html:b.a},onClick:this.handleTitleCollapsed})),o.default.createElement("div",{className:"doc-directory-content",ref:function(e){return t.content=e}},this.renderList())))}}]),n}();n(574);function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}n.d(e,"default",function(){return N});var N=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.updatePosition=this.updatePosition.bind(this),this.refresh=this.refresh.bind(this),this.onToggle=this.onToggle.bind(this),this.editorScrollingContainer=document.getElementById("editor-scroller"),this.editorContainer=document.getElementById("editor"),this.render()}return function(t,e,n){e&&j(t.prototype,e),n&&j(t,n)}(t,[{key:"render",value:function(){this.root=document.createElement("div"),this.root.classList.add("ql-table-of-content"),this.editorContainer.append(this.root),this.updatePosition(!0),this.componentInstance=o.default.render(o.default.createElement(P,{plugin:this,updatePosition:this.updatePosition,editorScrollingContainer:this.editorScrollingContainer,onToggle:this.onToggle}),this.root)}},{key:"show",value:function(){this.componentInstance.toggleTitleCollapsed(!1),r.b.track(4,"点击目录整体打开")}},{key:"hide",value:function(){this.componentInstance.toggleTitleCollapsed(!0),r.b.track(4,"点击目录整体折叠")}},{key:"toggle",value:function(){this.isShow?this.hide():this.show()}},{key:"destroy",value:function(){this.root.innerHTML=""}},{key:"updatePosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.root,n=this.editorScrollingContainer.getBoundingClientRect().top,o=this.editorContainer.offsetLeft;e.style.top="".concat(n,"px"),e.style.height=window.innerWidth<1280?"calc(100% - ".concat(n+this.scrollbarHeight,"px)"):"calc(100% - ".concat(n,"px)"),this.patchSpaceRight(),window.innerWidth>1460?(e.style.width="315px",e.style.left=null,e.style.marginLeft="-315px",e.style.background=null):window.innerWidth>1280?(e.style.width="".concat(o,"px"),e.style.left=0,e.style.marginLeft="auto",e.style.background=null):(e.style.width="".concat(o-6,"px"),this.patchSpaceRight(6),e.style.left=0,e.style.marginLeft="auto",!0===t?(e.style.background="initial",e.style.zIndex=""):(e.style.background="#F7F7F7",e.style.zIndex=100))}},{key:"patchSpaceRight",value:function(t){if(this.componentInstance){var e=this.componentInstance.getDOMNode();e.style.paddingRight=t?"".concat(parseFloat(window.getComputedStyle(e).paddingRight)-t,"px"):""}}},{key:"refresh",value:function(){this.componentInstance&&this.componentInstance.update()}},{key:"onToggle",value:function(t){this.root.classList.toggle("close",t)}},{key:"isShow",get:function(){return!this.componentInstance.state.collapsed}},{key:"scrollbarWidth",get:function(){return window.outerWidth-window.innerWidth||this.editorScrollingContainer.offsetWidth-this.editorScrollingContainer.scrollWidth}},{key:"scrollbarHeight",get:function(){var t=this.editorScrollingContainer.getBoundingClientRect().bottom;return window.innerHeight-t}}]),t}()}}]);